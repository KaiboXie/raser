[[周嘉奇]]
# Allpix2: A modular simulation framework for silicon detectors
硅探测器的模块化仿真框架 https://github.com/allpix-squared/allpix-squared

- 摘要
![|800](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%E6%91%98%E8%A6%81.png)
Allpix2是一个用于模拟硅探测器的开源的全面的模拟化软件框架，目标是简化单个探测器和更复杂的装置(如光束望远镜)从入射辐射到数字化探测器响应的详细模拟的实现，将实验装置中的材料效应模拟与沉积的电荷载体运动的详细描述相结合

- 框架体系架构
![](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%E6%A1%86%E6%9E%B6.png)
Allpix2是作为一个模块化框架构建的，它将中央基础设施组件与单个模块中实现的实际物理模拟分离开来。左图包含通用工具，右图的各个模块实现模拟过程。灰色虚线箭头表示探测器信息，蓝色虚线箭头表示日志信息，红色实线箭头构成消息的双向流。框架核心为模拟链中的所有模块四个基本组件，如上图所示:模块实例化逻辑、检测器几何、消息传递系统和用户界面。
- 模块实例化逻辑：框架的模块实例化逻辑直接从用户提供的配置文件中推断出模块实例化的数量及其检测器的分配。模块实例在框架启动时创建，并在整个仿真过程中使用。
- 检测器几何：模型是在独立的配置文件中描述的，其中有几个是随框架提供的。通过在几何配置中指定这些单个检测器的类型、位置和方向，将它们的实例放置在仿真设置的全局参考框架中。通过TCAD产生电场
- 消息传递系统：信息通过消息传递系统在不同模块之间进行交换。每个模块实例在启动时订阅特定的消息类型，并且在模拟期间将各自类型的所有消息以及可能的匹配检测器的消息转发给模块。模块处理完输入的数据后，可以向系统发送新的消息，以便将结果转发给其他模块。
在Allpix中实现的一个重要特性框架是对象历史:每个对象的完整来源都被记录下来﹐允许为每个单个对象重建完整的过程。这一特点允许将从模拟中检索到的每个像素点与初始粒子和它们的确切位置。
- 用户界面：提供了一个用于与用户交互的命令行界面。所有控制台输出都通过一个中央日志记录设施进行重定向，该设施允许配置模拟日志的详细程度、样式等。
- 仿真配置的例子
![|1000](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%E4%BE%8B%E5%AD%90.png)
简单设置带有单个检测器的Allpix2模拟链，其中每个块表示单个模块实例化。模块按照它们在配置文件中出现的顺序执行。首先，构造附加几何的结构并计算探测器的电场。然后，在植入物中沉积、传播和收集载流子。最后对信号进行数字化处理，并对仿真结果进行存储。

- 模拟流程
    - 生成额外的几何信息：如果有些模块需要检测器模型之外的信息，例如材料，Allpix2提供了GeometryBuilderGeant4模块，从内部检测器模型创建与Geant4兼容的几何描述。
    - 可视化：Allpix2提供VisualizationGeant4模块来实现可视化，可视化包括放置在装置中的所有探测器以及由Geant4模拟的主要和次要粒子。
    - 电场：电场由专门的模块ElectricFieldReader添加，相当于在实验室或测试光束测量中打开高压电源。目前，两种类型的电场剖面可以应用于探测器:线性电场或从TCAD导入的场图。
    - 载流子的沉积：Allpix2中的相关模块模块为DepositionGeant4，该模块充当Geant4的接口，Geant4在整个设置周围的体积中进行粒子的生成和传播。
    - 载流子的传播：目前在Allpix2中实现了两种不同的方法，它们具有不同的复杂性。其中最简单(也因此最快)的是ProjectionPropagation模块。这种实用的方法可以产生足够精确的结果，特别是当各自的探测器仅用于参考时。另一个GenericPropagation模块中实现了一种更详细的算法。
    - 从传感器传输到读出芯片：Allpix2在电荷载流子的传播和前端电子器件的数字化之间引入了一个额外的步骤，即信号从传感器到读出芯片的传输。这一步骤为具有不同互连技术的探测器的模拟链增加了额外的灵活性。在单片传感器或混合探测器中，用较为简单SimpleTransfer模块。对于具有电容耦合传感器的混合像素检测器，用CapacitiveTransfer模块。
    - 存储仿真结果：由模块rootobjectwwriter生成并写入文件，该模块还存储框架和模块配置的完整文本以及各自模拟中使用的检测器设置。
- 仿真例子并与实验数据进行比较
目前的Allpix2模块是以第一原理方法实现的，有望准确地再现数据。
该模拟的唯一输入是光束属性和Geant4物理列表、实验装置的几何形状以及下图中列出的被测设备和望远镜的操作参数。
![|700](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%E5%8F%82%E6%95%B0.png)

可视化的模拟探测器
![](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%E6%A8%A1%E6%8B%9F%E5%9B%BE.png)

仿真结果与数据比较
![](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%E6%AF%94%E8%BE%83.png)
模拟结果和数据非常相近，一小部分的差别作者推测归因于器件本身实际阈值的变化，这个可以通过调整模拟的阈值进一步减少差距；或者是因为在对准后DUT残留的不对准造成的。
该框架已被证明在将数据与模拟结果相比较时表现非常好，只需调整一些已知的参数。模拟都非常接近于从数据中获得的结果。
作者还想加入新的模块，用于模拟激光的电荷沉积，利用拉莫加权场模拟电荷载流子输运过程中探测器植入体中感应电流的瞬态效应，以及辐射损伤对硅传感器的影响。