
# 探测器快时间探测数据采集原理

报告人： [[肖素玉]]

山东高等技术研究院

2023年1月11日

---

## 探测器测试系统示意 

![读出.png|500](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%25E8%25AF%25BB%25E5%2587%25BA.png)

---

## 激光
![吸收深度.png|400](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%25E5%2590%25B8%25E6%2594%25B6%25E6%25B7%25B1%25E5%25BA%25A6.png)
在硅材料中，红光的吸收长度约为3um，可用于top-TCT扫描，来确定探测器的一致性和死区等问题；红外激光的吸收长度约为1mm，可用于edge-TCT扫描，来研究探测器深度相关的问题，如纵向电场变化。

---

## 硅探测器

![5 LGAD倍增.png|500](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/5%2520LGAD%25E5%2580%258D%25E5%25A2%259E.png)
当有粒子（光子、电子、质子等）穿过LGAD时，在硅探测器中沉积能量并激发电子空穴对，电子空穴对在外加电场的影响下产生定向运动。当载流子经过增益区时，实现倍增过程，倍增载流子在外加电场的影响下继续运动并被电极收集。


---

## 读出板仿真

![电路图.png](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%E7%94%B5%E8%B7%AF%E5%9B%BE.png)

图中画圈器件可能会对信号放大倍数产生影响，用LTspice进行仿真，修改器件的大小，研究输出信号与输入信号之间的关系。

---

C1取值与输出信号之间的关系
![C1](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/C1.png)

---

C2取值与输出信号之间的关系
![C2](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/C2.png)

---

C5取值与输出信号之间的关系
![C5](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/C5.png)

---

C6取值与输出信号之间的关系
![C6](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/C6.png)

---

R2取值与输出信号之间的关系
![R2](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/R2.png)

---

R1取值与输出信号之间的关系
![R1](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/R1.png)
修改R1从而改变前放的放大倍数，可以实现对于较小信号的读出。

--- 

## 示波器

![示波器.png|500](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%25E7%25A4%25BA%25E6%25B3%25A2%25E5%2599%25A8.png)

示波器是设计和测试电子设备和器件最常用的工具，用于显示及测量随时间变化的电子信号。

---

### 波形特性

电子信号以波形或脉冲的形式出现，基本特性包括：

幅度 - 经常使用的幅度定义主要有两个。第一种为峰值幅度，是信号的最大位移量；第二种是均方根幅度，将波形值平方并求出平均电压后再求平方根。正弦波情况下，RMS幅度等于0.707倍峰值幅度。

相移 - 相移是指两个其他条件都相同的波形之间的水平位移量，以度或弧度为单位。正弦波的周期以 360 度来表示。因此，如果两个正弦波相差半个周期，那么它们的相对相移就是 180 度。

---

周期 - 波形的周期是指波形重复出现一次所花费的时间，以秒为单位。

频率 - 每个周期性波形都有一个频率。频率是指波形在一秒内重复出现的次数（ Hz ）。频率与周期互为倒数。

---

### 波形

![正弦波.png|300](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%25E6%25AD%25A3%25E5%25BC%25A6%25E6%25B3%25A2.png)
正弦波 - 通常与交流电源有关。正弦波的峰值幅度并非一直恒定，如果峰值幅度会随着时间不断地下降，我们就称这种波形为阻尼正弦波。

---

![方波.png|300](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%25E6%2596%25B9%25E6%25B3%25A2.png)
方波/矩形波 - 方波会在两个不同的值之间周期性地跳动，因此在高点和低点部分的长度会相等。矩形波不同的地方在于高、低点部分的长度并不相等。

---

![三角波.png|300](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%25E4%25B8%2589%25E8%25A7%2592%25E6%25B3%25A2.png)
三角波 / 锯齿波 - 在三角波中，电压会随着时间呈线性变化。它的信号边沿称为斜波，这是因为其波形会斜升或斜降到某个电压。由于锯齿波前面或后面的信号沿会随着时间产生线性的电压响应，所以看起来与三角波类似。但对面的信号沿几乎是立即下降的。

---

![脉冲.png|300](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%25E8%2584%2589%25E5%2586%25B2.png)
脉冲 - 脉冲是指突然出现在固定电压中的干扰。如果信号只传送一条信息，那么脉冲也可看作是一个波形。


---

### 模数转换器ADC 

示波器的ADC模块负责将示波器前端放大器输入的模拟电信号转换成数字信号交给后台进行处理是示波器的核心，同时也是示波器主要指标的决定性部件。
![示波器采样.png|400](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%25E7%25A4%25BA%25E6%25B3%25A2%25E5%2599%25A8%25E9%2587%2587%25E6%25A0%25B7.png)
模拟信号经过采样、保持、量化与编码几个过程将模拟电压信号转换为数字信号。

---

采样：以一定的时间间隔提取信号的大小的操作称为采样，其值为样本值，提取信号大小的时间间隔越短越能正确地重现信号。由于缩短时间间隔会导致数据量增加，所以要选择合适的采样频率。

量化：采样后的信号幅度仍然是连续的值（模拟量）。此时可以在振幅方向上以某一定的间隔进行划分，决定个样本值属于哪一区间，将记在其区间的值分配给其样本值。将区间分割为0-0.5、0.5-1.5、1.5-2.5，再用0、1、2……代表各区间，对小数点后面的值，按照四舍五入处理，比如，201.6 属于201.5-202.5，则赋值202；123.4 属于122.5-123.5，则赋值123。

---

编码：将量化后的信号转换为二进制数，即用0 和1 的码组合来表示的处理过程称为编码，“1”表示有脉冲，“0”表示无脉冲。 所以一个模拟的数值最后会被用一个2的n次的二进制数值表示。 这个二进制数值的n表示了ADC模块的位数，即数据量化过程中的幅值的刻度数。如 6位ADC，量化级数取为64 级 8位ADC，量化级数取为256级。 位数越高，ADC数据采样准确率越高，对ADC模块的要求也越高。

---

数模转换模块除了示波器，在很多常用的仪器上叶都是常见的组成部分，例如，万用表，数据采集卡，逻辑分析仪，电源分析仪等等。在这些设备里面，有些设备需要有多个通道，多通道数据采集方法可分为异步和同步两种。

异步采集：由2个或者2个以上采集通道的设备共用一个ADC模块，每一个通道的信号由ADC模块交替采样。

同步采集：设备的多个数据采集通道，每一路模拟量输入通道，都会配有一个单独的AD转换芯片，因此每个通道可以独立采集。

---

分辨率、转换速率、采样速率是衡量ADC性能的重要参数。

1. 分辨率：数字量变化一个最小量时模拟信号的变化量，定义为满刻度与2n的比值，通常以数字信号的位数来表示。
2. 转换速率：转换速率是指A/D转换一次所需要时间的倒数，即单位时间内完成A/D转换的次数。
3. 采样速率：采样速率是两次采样（两次转换）的间隔时间的倒数，为了保证转换的正确完成，一般采样速率必须小于等于转换速率，即采样时间大于等于转换时间。

---


### 带宽

带宽，通讯线路或设备所能传送信号的范围，通常是指正弦波信号被衰减至信号-3dB功率时的频率，即3dB带宽。如1GHz，1V的正弦波，通过1GHz示波器观察到的信号为1GHz，0.707V。
如果信号时正弦波，则可以选择相同带宽的示波器，但是对于方波信号，则不能简单的选取同样带宽的示波器。

---

![方波带宽相同.png|500](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%25E6%2596%25B9%25E6%25B3%25A2%25E5%25B8%25A6%25E5%25AE%25BD%25E7%259B%25B8%25E5%2590%258C.png)
若直接使用同样带宽的示波器测试方波，会使方波被“剥削”，从而得到近似正弦波的测试结果。

---

对于非正弦波的波形，选择仪器时需要考虑其谐波分量。我们对方波做傅里叶级数展开，得到其只含有奇数次谐波分量。随着谐波频率升高，能量占比下降，具体关系为：
![方波展开.png|500](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%25E6%2596%25B9%25E6%25B3%25A2%25E5%25B1%2595%25E5%25BC%2580.png)

---

对展开式形象化可得到下图：

![方波展开图.png|500](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%25E6%2596%25B9%25E6%25B3%25A2%25E5%25B1%2595%25E5%25BC%2580%25E5%259B%25BE.png)
由此，选择示波器的带宽大于等于被测信号的奇数次谐波，可以更好地保存信号的能量，使信号更完整在测试端得到复现。具体需要多少倍呢？

---

上升时间，信号从逻辑0到逻辑1的过程。通常选用10%-90%的部分作为10-90上升时间，同样也可以选择20%-80%的部分。以10%-90%为例，信号上升时间如下图所示：
![上升时间.png|500](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%25E4%25B8%258A%25E5%258D%2587%25E6%2597%25B6%25E9%2597%25B4.png)

上升时间和方波信号带宽之间成反比，对于高斯相应系统，其数学关系为：带宽$\times$上升时间=0.35。对不同的响应系统，乘积会发生变化，一般都在0.35-0.45之间波动，此信息可在示波器厂商的产品手册上查询。

---

对于高速信号而言，逻辑电平值变化的过程是测试阶段最容易出错的，值得我们投入大量的精力关注。如果我们可以把上升时间测准，也就可以解决这个问题。回到上面出现过的图，带宽选择失误在定量的表现为，上升时间的测试误差：上升变慢了。
待测信号的测试值与真实值之间的关系如下：

![上升时间计算.png](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%25E4%25B8%258A%25E5%258D%2587%25E6%2597%25B6%25E9%2597%25B4%25E8%25AE%25A1%25E7%25AE%2597.png)
上升时间和带宽成反比，即三倍带宽对应三分之一上升时间，五倍带宽对应五分之一上升时间。

---

对1GHz方波信号来说，选用不同带宽示波器测得的上升时间为：
![几倍带宽.png|500](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%25E5%2587%25A0%25E5%2580%258D%25E5%25B8%25A6%25E5%25AE%25BD.png)

通过定量计算，得到了选择不同带宽倍数的示波器后测试的上升时间与误差率，便于我们更好的做出系统的搭建。从上表的计算结果，要求我们在测试时至少3倍带宽是有必要的。

---

除了选择合适的示波器，测试时也要考虑连接器对于带宽的限制。

![sma.png|300](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/sma.png)

上图所示为SMA连接器，适用频率范围为0-18GHz，是超小型的、适合半硬或者柔软射频同轴电缆的连接，具有尺寸小、性能优越、可靠性高、使用寿命长等特点。但是超小型的接头在工程中容易被损坏，适合要求高性能的微波应用场合，如微波设备的内部连接。

---

![bnc.png|300](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/bnc.png)

上图所示为BNC连接器，适用的频率范围为0~4GHz，是用于低功率的具有卡口连接机构的同轴电缆连接器。这种连接器可以快速连接和分离，具有连接可靠、抗振性好、连接和分离方便等特点，适合频繁连接和分离的场合，广泛应用于无线电设备和测试仪表中连接同轴射频电缆。

---

### 采样率

信号是在不断变化的，采样率是另一个示波器的关键参数。示波器的采样率就是示波器每秒能采集多少个数据点的能力，如果示波器的采样率不足，那么我们就无法准确地看到信号的真实样子。

---

输入示波器的信号在时间轴和电压轴上也都是连续变化的，由于计算机只能处理离散的数字信号，像这样的信号是无法用数字的方法进行描述和处理，因此还需要用高速ADC对信号进行采样和量化，也就是数字化的过程。经过模数转换后，在时间和电压上连续变化的波形就变为一个个连续变化的数字化的采样点。

在进行采样或者进行数字量化的过程中，如果要尽可能真实地重建波形，最关键的问题就是在时间轴上的采样点是否足够密集以及在垂直方向的电压的量化级数。水平方向采样点的间隔取决于示波器的ADC的采样率，而垂直方向的电压量化级数则取决于ADC的位数。

---

示波器的运作过程大致如下：

![示波器工作过程.png|600](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%25E7%25A4%25BA%25E6%25B3%25A2%25E5%2599%25A8%25E5%25B7%25A5%25E4%25BD%259C%25E8%25BF%2587%25E7%25A8%258B.png)
我们通过探头给示波器输入一个信号，被测信号经过示波器前端的放大、衰减等信号调理电路后，然后高速ADC模数转换器进行信号采样和数字量化，示波器的采样率就是对输入信号进行模数转换时采样时钟的频率，通俗的讲就是采样间隔，每个采样间隔采集一个采样点。比如1GSa/s的采样率，代表示波器具备每秒钟采集10亿个采样点的能力，此时其采样间隔就是1ns。

大多数示波器会提供几种采样模式供用户选择，常见的有正常采样、平均采样、峰值采样和包络采样。

---

正常采样模式下，示波器按相等的时间间隔对信号采样以重建波形。此模式可对大部分波形产生最佳显示效果。

使用平均采样模式可平均多个采集结果，以减少所显示信号中的随机或无关噪声。平均多个采样结果需要稳定的触发。平均的数目可在平均采样模式后的选择框内进行设定，平均数目越高，显示的波形对波形变化的响应就越慢。

在峰值采样模式中，当水平时基设置较低时，将保留最小采样值和最大采样值，以捕获罕见事件和窄事件（在扩大任何噪声的前提下）。峰值采样模式可用于更方便地查看毛刺或窄脉冲。

---

使用包络采样模式可以看到数次采样到的波形的叠加效果，在指定的N个采样数据中捕获一个信号的最大值和最小值，可设置波形叠加次数。

无论选择了哪种采样方式，都要记住保证采样率至少是被测信号带宽的2倍以上，事实上我们更建议是3-5倍以上，这样更容易捕获的波形的异常信息。多通道情况下，采样率会被每个通道平均分配。因此如果打开了多个通道，一定要再次确认下采样率是否依然满足条件。

---

我们以MSOS804A为例，该示波器有4通道，8GHz带宽，20 GSa/s采样率。 MSOS804A有4个最大采样率10 GSa/s的ADC模块，其中通道1，通道2的ADC模块组成一个ADC模块组。 当单独使用1通道或者单独使用2通道时，因为有2个采样率10 GSa/s的ADC模块协同工作，所以示波器的带宽可以到达8GHz，采样率最大可以到20 GSa/s。 当1，2通道一起使用时，只能使用本通道内的ADC模块，所以此时示波器的带宽只有4GHz，最大采样率10 GSa/s。3/4通道也是同样的道理。

综上所述，在示波器的使用过程中，如果客户使用2个通道，建议各户使用1、3或者2、4通道以提高测试结果准确度。

---

### 阻抗匹配 

在理想情况下，对被测仪器进行测试时不应影响它的正常工作，测量值也应和未接测试仪器时相同.当连接仪器进行测量时，要考虑阻抗对测量准确性的影响，为了保证仪器之间能够传送最大的功率，阻抗应该匹配。探头的阻抗匹配是指探头与示波器电路的阻抗匹配，主要是电容效应，当阻抗不匹配时，信号会在探头与示波器的接口上产生反射，从而产生振荡。
![阻抗不匹配.png|500](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%25E9%2598%25BB%25E6%258A%2597%25E4%25B8%258D%25E5%258C%25B9%25E9%2585%258D.png)

---

如果阻抗为纯电阻，应使输入阻抗与输出阻抗的值相等。
![阻抗匹配.png|500](https://raser-1314796952.cos.ap-beijing.myqcloud.com/media/%25E9%2598%25BB%25E6%258A%2597%25E5%258C%25B9%25E9%2585%258D.png)

阻抗匹配的阻抗值通常和使用的传输线的特性阻抗值一致。示波器本身也有输入阻抗的，探头的阻抗应该和示波器的阻抗一致起来。50$\Omega$输入阻抗灵敏度更高，不能测大电压，1M$\Omega$输入阻抗时，能测更大的电压。

---

## 总结

1. 读出电路器件大小对输出波形影响
2. 示波器选择依据：带宽、采样率等
